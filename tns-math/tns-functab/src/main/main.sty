% == PACKAGES == %

\RequirePackage{nicematrix}[6.26]


% == TOOLS == %

\ExplSyntaxOn

% -- DSL - L3 -- %

% :: RESCAN TRICK :: %

% Source.
%     + https://tex.stackexchange.com/a/706773/6880

\tl_new:N   \g_pmbc_splitsemicolon_semicolon_tl
\tl_gset:Nn \g_pmbc_splitsemicolon_semicolon_tl { ; }

\tl_new:N   \g_pmbc_splitcolon_colon_tl
\tl_gset:Nn \g_pmbc_splitcolon_colon_tl { : }

\cs_generate_variant:Nn \seq_set_split_keep_spaces:Nnn { NV }

\AtBeginDocument {
  \tl_gset_rescan:NnV \g_pmbc_splitsemicolon_semicolon_tl 
                      {}
                      \g_pmbc_splitsemicolon_semicolon_tl
                      
  \tl_gset_rescan:NnV \g_pmbc_splitcolon_colon_tl 
                      {}
                      \g_pmbc_splitcolon_colon_tl
}


% :: ORCHESTRA CONDUCTOR :: %

\NewDocumentEnvironment{functable}{ b }{%
  WIP-SEMI-COLON:
  \par
  \medskip
  \pmbc_splitsemicolon:n { #1 } %
  
  \par
  \bigskip
  WIP-COLON:
  \par
  \medskip
  \pmbc_splitcolon:n { #1 } %
}{}

\cs_new:Npn \pmbc_splitsemicolon:n #1 {
  \seq_set_split_keep_spaces:NVn \l_tmpa_seq 
                                 \g_pmbc_splitsemicolon_semicolon_tl 
                                 { #1 }

  $
  	\seq_use:Nn \l_tmpa_seq { $\par\smallskip$ }
  $
}

\cs_new:Npn \pmbc_splitcolon:n #1 {
  \seq_set_split_keep_spaces:NVn \l_tmpa_seq
                                 \g_pmbc_splitcolon_colon_tl
                                 { #1 }

  $
  	\seq_use:Nn \l_tmpa_seq { $\par\smallskip$ }
  $
}

\ExplSyntaxOff

