% == PACKAGES == %

\RequirePackage{nicematrix}[6.26]
\RequirePackage{starray}[Version 1.5 - November 2023]


% == TOOLS == %

\ExplSyntaxOn

% -- DSL - L3 -- %

% :: RESCAN TRICK :: %

% Source.
%   + https://tex.stackexchange.com/a/706773/6880

\tl_new:N   \g_tns_functab_semicolon_tl
\tl_gset:Nn \g_tns_functab_semicolon_tl { ; }

\tl_new:N   \g_tns_functab_colon_tl
\tl_gset:Nn \g_tns_functab_colon_tl { : }

\cs_generate_variant:Nn \seq_set_split_keep_spaces:Nnn { NV }

\AtBeginDocument {
  \tl_gset_rescan:NnV \g_tns_functab_semicolon_tl
                      {}
                      \g_tns_functab_semicolon_tl

  \tl_gset_rescan:NnV \g_tns_functab_colon_tl
                      {}
                      \g_tns_functab_colon_tl
}


% :: ORCHESTRA CONDUCTOR :: %

\NewDocumentEnvironment{functable}{ b }{%
  WIP:
  \tns_functab_build_starray:n { #1 } %
}{}


% :: INTERNAL DATA STRUCTURE :: %

\cs_new:Npn \tns_functab_build_starray:n #1 {
  TODO...
}

\cs_new:Npn \tns_functab_split_semicolon:n #1 {
  \seq_set_split_keep_spaces:NVn \l_tmpa_seq
                                 \g_tns_functab_semicolon_tl
                                 { #1 }

  $
  	\seq_use:Nn \l_tmpa_seq { $\par\smallskip$ }
  $
}

\cs_new:Npn \tns_functab_split_colon:n #1 {
  \seq_set_split_keep_spaces:NVn \l_tmpa_seq
                                 \g_tns_functab_colon_tl
                                 { #1 }

  $
  	\seq_use:Nn \l_tmpa_seq { $\par\smallskip$ }
  $
}

\ExplSyntaxOff
